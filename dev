#!/bin/bash -eu
>&2 echo "For your convenience: 
  
    var s = document.createElement('script');
    s.src = 'http://localhost:29684/client-dev.js';
    document.body.appendChild(s);";
set -vx

cd "$(dirname $0)"

npm install --dev  .

(node_modules/.bin/babel \
    --stage 1 \
    --watch \
    --source-maps inline \
    client-src/ \
    --out-dir dist/)&

(node_modules/.bin/watchify \
    client-src/main.js \
    -t [ babelify --stage 1 ] \
    --debug \
    --outfile dist/client-dev.js)&

(node_modules/.bin/http-server \
    dist/ \
    -a localhost \
    -p 29684 \
    -c -1);

